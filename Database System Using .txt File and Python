import random as rand


def crt():
    a = open('Dtb.txt', 'a+')
    dtr = a.readlines()
    ids = rand.randint(1000, 9999)
    p = 0
    for i in dtr:
        g = i.split(' - ')
        if g[0] == ids:
            ids = rand.randint(1000, 9999)
            p = p + 1
        elif p == 8999:
            ids = rand.randint(10000, 99999)
    name = input('Enter Name : ')
    dob = input('Enter DOB (dd-mm-ccyy) : ')
    gender = input('Enter Gender(M/F) : ')
    mail = input('Enter Email : ')
    print(f'\nYour information hase been successfully added\n\nYour id is {ids}\n')

    dt = f'{ids} - {name} - {dob} - {gender} - {mail}\n'
    a.write(dt)
    a.close()


def readfile():
    a = open('Dtb.txt', 'r')
    dt = a.readlines()
    print(f'These are the ids present in the database\n')
    for i in dt:
        g = i.split(' - ')
        print(g[0])
        print()
        a.close()


def readinfo():
    a = open('Dtb.txt', 'r')
    dtr = a.readlines()
    ids = input('Enter Your id : ')
    h = 0
    for i in dtr:
        g = i.split(' - ')
        if g[0] == ids:
            print(f'''
Name : {g[1]}
DOB : {g[2]}
Gender : {g[3]}
Email : {g[4]}''')
            h = 1
            a.close()
    if h == 0:
        print('\nNo Data Present\n')


def deleteinfo():
    a = open('Dtb.txt', 'r')
    dtr = a.readlines()
    ids = int(input('Enter Your id : '))
    p = 0
    for i in dtr:
        g = i.split(' - ')
        if int(g[0]) == ids:
            dtr.pop(p)
            print('Data has been successfully deleted\n')
            break
        else:
            p = p + 1
    else:
        print('No such id present\n')
    a.close()
    a = open('Dtb.txt', 'w')
    for i in dtr:
        a.write(f'{i}\n')
    a.close()


def editinfo():
    a = open('Dtb.txt', 'r')
    dtr = a.readlines()
    ids = input('Enter Your id : ')
    p = 0
    a.close()
    h = 0
    for i in dtr:
        g = i.split(' - ')
        if g[0] == ids:
            print('Enter New Data')
            name = input('Enter Name : ')
            dob = input('Enter DOB (dd-mm-ccyy) : ')
            gender = input('Enter Gender(M/F) : ')
            mail = input('Enter Email : ')
            print('')
            a = open('Dtb.txt', 'w')
            c = f'{ids} - {name} - {dob} - {gender} - {mail}\n'
            dtr[p] = c
            for k in dtr:
                a.write(k)
            a.write('\n')
            a.close()
            print('Data Edited Successfully\n')
            h = 1
            break
        else:
            p = p + 1
    if h == 0:
        print('\nNo such data to be Edited\n')


func = {1: crt,
        2: readfile,
        3: readinfo,
        4: editinfo,
        5: deleteinfo}

while True:
    print('''1. Create Data
2. Read Entire Database
3. Read Information
4. Edit Info
5. Delete Information
0. Exit
''')
    ch = int(input('Enter Choice (Sno.): '))
    if ch == 0:
        break
    elif ch not in func:
        print('No such function')
    else:
        func[ch]()
